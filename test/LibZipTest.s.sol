// SPDX-License-Identifier: MIT
pragma solidity ^0.8.4;

import "forge-std/Test.sol";
import {LibZip} from "../src/libraries/LibZip.sol"; // Adjust path if your src/ is different

contract LibZipTest is Test {
    using LibZip for bytes; // Optional: Enables `data.flzCompress()` syntax

    function testFlzCompress() public pure {
        bytes memory inputData = hex"0a4261636b67726f756e640019000000ff020202ff070707ff0f0f0fff161616ff1e1e1eff272727ff333333ff404040ff4e4e4eff5e5e5eff6e6e6eff808080ff919191ffa2a2a2ffb3b3b3ffb5b5b5ffc3c3c3ffd2d2d2ffdfdfdfffeaeaeafff3f3f3fffafafafffefefeffffffffff011300000000000001075261696e626f770001000000000205536f6c6964100002000000ff030f536d6f6f746820566572746963616c00180018000000ff0412506978656c6174656420566572746963616c18171615141312110f0e0d0c0b0a090807060504030201000002000000ff0317536d6f6f746820566572746963616c20496e766572736518000018000000ff041a506978656c6174656420566572746963616c20496e7665727365000102030405060708090a0b0c0d0e0f111213141516171800020000ff000511536d6f6f746820486f72697a6f6e74616c001800180000ff000614506978656c6174656420486f72697a6f6e74616c18171615141312110f0e0d0c0b0a0908070605040302010000020000ff000519536d6f6f746820486f72697a6f6e74616c20496e7665727365180000180000ff00061c506978656c6174656420486f72697a6f6e74616c20496e7665727365000102030405060708090a0b0c0d0e0f111213141516171800020000ffff070f536d6f6f746820446961676f6e616c001800180000ffff080e506978656c20446961676f6e616c18171615141312110f0e0d0c0b0a0908070605040302010000020000ffff0717536d6f6f746820446961676f6e616c20496e7665727365180000180000ffff0816506978656c20446961676f6e616c20496e7665727365000102030405060708090a0b0c0d0e0f1112131415161718000200ffff000917536d6f6f7468205265766572736520446961676f6e616c0018001800ffff000a16506978656c205265766572736520446961676f6e616c18171615141312110f0e0d0c0b0a09080706050403020100000200ffff00091f536d6f6f7468205265766572736520446961676f6e616c20496e76657273651800001800ffff000a1e506978656c205265766572736520446961676f6e616c20496e7665727365000102030405060708090a0b0c0d0e0f11121314151617180002808080800b0652616469616c1800";

        bytes memory compressed = LibZip.flzCompress(inputData);

        // console.log("\n\n");
        console.log("Input length:", inputData.length, "\n");
        // console.logBytes(inputData);
        // console.log("\n\n");
        console.log("Compressed length:", compressed.length, "\n");
        console.logBytes(compressed);
        console.log("\n\n");

        assertTrue(
            compressed.length < inputData.length || inputData.length == 0
        );
    }
}
